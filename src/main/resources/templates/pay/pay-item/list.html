<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{common/base}">
<head>
	<title>급여 항목 관리</title>
</head>

<body>
	<div layout:fragment="content">
		<div th:replace= "~{common/sidebar :: sidebar}" >
		</div>
		<div class="page-wrapper">
			<div class="content">

				<div class="card">
					<div class="card-header">
						<h5 class="card-title">검색 조건</h5>
					</div>
					<div class="card-body">
						<div id="pay-item-search-box">
							<form action="/pay/pay-item" method="get">
								<div class="row">
									<div class="col-md-3">
										<div class="form-group">
											<label>항목명</label>
											<select name="itemCode" multiple="multiple" class="form-control" id="searchPayItemSelect">
	                                        	<option th:each="p : ${searchPayItemList}" th:value="${p.itemCode}" th:text="|${p.itemName} (${p.itemCode})|" th:selected="${itemCode != null && #lists.contains(itemCode, p.itemCode)}"></option>
	                                        </select>
										</div>
									</div>
									<div class="col-md-3">
									    <div class="form-group">
									        <label for="itemTypeSelect">항목 유형</label>
									        <select class="form-select multiple-select" name="itemTypes" id="itemTypeSelect" multiple="multiple">
									            <option value="PAY" th:selected="${itemTypes != null && #lists.contains(itemTypes, 'PAY')}">PAY</option>
									            <option value="DEDUCT" th:selected="${itemTypes != null && #lists.contains(itemTypes, 'DEDUCT')}">DEDUCT</option>
									            <option value="TAX" th:selected="${itemTypes != null && #lists.contains(itemTypes, 'TAX')}">TAX</option>
									            <option value="INSURANCE" th:selected="${itemTypes != null && #lists.contains(itemTypes, 'INSURANCE')}">INSURANCE</option>
									            <option value="BACKPAY" th:selected="${itemTypes != null && #lists.contains(itemTypes, 'BACKPAY')}">BACKPAY</option>
									        </select>
									    </div>
									</div>
									<div class="col-md-3">
										<div class="form-group">
											<label for="search_useYn">사용 여부</label>
											<select class="form-select" name="useYn" id="search_useYn">
												<option value="">전체</option>
												<option value="Y" th:selected="${useYn == 'Y'} ">Y</option>
												<option value="N" th:selected="${useYn == 'N'}">N</option>
											</select>
										</div>
									</div>
									<div class="col-md-3 d-flex align-items-end">
										<div class="form-group w-100">
											<button type="submit" class="btn btn-primary w-100">조회</button>
										</div>
									</div>
								</div>
							</form>
						</div>
					</div>
				</div>

				<div class="card">
					<div class="card-header">
						<h5 class="card-title">항목 목록</h5>
					</div>
					<div class="card-body">
						<div class="table-responsive">
							<table class="table table-striped table-hover datatable-resizable" id="dataTable">
								<thead class="table-light">
									<tr>
										<th>항목코드</th>
										<th>항목명</th>
										<th>유형</th>
										<th>과세</th>
										<th>절사방식</th>
										<th>사용여부</th>
										<th>수정</th>
									</tr>
								</thead>
								<tbody>
									<tr th:each= "z : ${payItem}">
										<td th:text="${z.itemCode}"></td>
										<td th:text="${z.itemName}"></td>
										<td th:text="${z.itemType}"></td>
										<td>
										    <input type="checkbox" class="form-check-input" th:checked="${z.taxYn == 'Y'}" onclick="return false;">
										</td>
										<td th:text="${z.roundType}"></td>
										<td>
										    <input type="checkbox" class="form-check-input" th:checked="${z.useYn == 'Y'}" onclick="return false;">
										</td>
										<td><button class="btn btn-primary edit-btn"  data-bs-toggle="modal" data-bs-target="#editModal" th:data-value="${z.itemCode}">수정</button></td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>

				<div class="modal fade" id="addModal" tabindex="-1" aria-labelledby="addModalLabel" aria-hidden="true">
				    <div class="modal-dialog modal-xl modal-dialog-centered">
				        <div class="modal-content">
				            <div class="modal-header">
				                <h5 class="modal-title" id="addModalLabel">신규 항목 등록</h5>
				                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				            </div>
				            <div class="modal-body">
				                <form id="addPayItem">
				                    <div class="row">
				                        <div class="col-md-4 mb-3">
				                            <div class="form-group">
				                                <label>항목코드 <span class="text-danger">*</span></label>
				                                <input type="text" class="form-control" name="itemCode" required="required" maxlength="20">
				                            </div>
				                        </div>
				                        <div class="col-md-4 mb-3">
				                            <div class="form-group">
				                                <label>항목명 <span class="text-danger">*</span></label>
				                                <input type="text" class="form-control" name="itemName" required="required" maxlength="100">
				                            </div>
				                        </div>
				                        <div class="col-md-4 mb-3">
				                            <div class="form-group">
				                                <label>유형</label>
				                                <select class="form-select" name="itemType">
				                                    <option value="PAY">PAY</option>
				                                    <option value="DEDUCT">DEDUCT</option>
				                                    <option value="INSURANCE">INSURANCE</option>
				                                    <option value="TAX">TAX</option>
				                                    <option value="BACKPAY">BACKPAY</option>
				                                </select>
				                            </div>
				                        </div>
				                        <div class="col-md-4 mb-3">
				                            <div class="form-group">
				                                <label>과세여부</label>
				                                <div class="form-check">
										            <input type="hidden" value="N" name="taxYn"> 
										
										            <input class="form-check-input" type="checkbox" value="Y" name="taxYn"  checked>
										        </div>
				                            </div>
				                        </div>
				                        <div class="col-md-4 mb-3">
				                            <div class="form-group">
				                                <label>과세방식</label>
				                                <select class="form-select" name="taxType" onchange="checkTaxType(this)">
				                                    <option value="">선택...</option>
				                                    <option value="PERCENT">PERCENT</option>
				                                    <option value="AMOUNT">AMOUNT</option>
				                                </select>
				                            </div>
				                        </div>
				                        <div class="col-md-4 mb-3">
				                            <div class="form-group">
				                                <label>과세비율</label>
				                                <input type="number" step="0.01" class="form-control" min="0" max="999.99" name="taxPercent">
				                            </div>
				                        </div>
				                        <div class="col-md-4 mb-3">
				                            <div class="form-group">
				                                <label>절사방식</label>
				                                <select class="form-select" name="roundType">
				                                    <option value="WON">WON</option>
				                                    <option value="TEN">TEN</option>
				                                    <option value="HUNDRED">HUNDRED</option>
				                                </select>
				                            </div>
				                        </div>
				                        <div class="col-md-4 mb-3">
				                            <div class="form-group">
				                                <label>소급여부</label>
				                                <div class="form-check">
										            <input type="hidden" value="N" name="backPayYn"> 
										
										            <input class="form-check-input" type="checkbox" value="Y" name="backPayYn" >
										        </div>
				                            </div>
				                        </div>
				                        <div class="col-md-4 mb-3">
				                            <div class="form-group">
				                                <label>4대보험 대상여부</label>
				                                <div class="form-check">
										            <input type="hidden" value="N" name="insuranceYn"> 
										
										            <input class="form-check-input" type="checkbox" value="Y" name="insuranceYn"  checked>
										        </div>
				                            </div>
				                        </div>
				                        <div class="col-md-4 mb-3">
				                            <div class="form-group">
				                                <label>사용여부</label>
				                                <div class="form-check">
										            <input type="hidden" value="N" name="useYn"> 
										
										            <input class="form-check-input" type="checkbox" value="Y" name="useYn"  checked>
										        </div>
				                            </div>
				                        </div>
				                        <div class="col-md-8 mb-3">
				                            <div class="form-group">
				                                <label>비고</label>
				                                <textarea class="form-control" rows="2" name="note" maxlength="500"></textarea>
				                            </div>
				                        </div>
				                    </div>
				                    </form>
				            </div>
				            <div class="modal-footer gap-2">
				                <button type="reset" form="addPayItem" class="btn btn-outline-secondary">
				                    <i class="fas fa-redo-alt me-1"></i> 초기화
				                </button>
				                <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">취소</button>
				                <button type="button" class="btn btn-primary" onclick="addNewPayItem()">저장</button>
				            </div>
				        </div>
				    </div>
				</div>
				<div class="my-3 text-end">
					<button type="button" id="addButton" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addModal">신규 등록</button>
				</div>
				<div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
				    <div class="modal-dialog modal-xl modal-dialog-centered">
				        <div class="modal-content">
				            <div class="modal-header">
				                <h5 class="modal-title" id="editModalLabel">항목 정보 수정</h5>
				                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				            </div>
				            <div class="modal-body">
				                <form id="editPayItemForm">
				                    <div class="row">
				                        <div class="col-md-4 mb-3">
				                            <div class="form-group">
				                                <label>항목코드</label>
				                                <input type="text" class="form-control" name="itemCode" readonly>
				                            </div>
				                        </div>
				                        <div class="col-md-4 mb-3">
				                            <div class="form-group">
				                                <label>항목명</label>
				                                <input type="text" class="form-control" name="itemName" >
				                            </div>
				                        </div>
				                        <div class="col-md-4 mb-3">
				                            <div class="form-group">
				                                <label>유형</label>
				                                <input type="text" class="form-control" name="itemType" readonly>
				                            </div>
				                        </div>
				                        <div class="col-md-4 mb-3">
				                            <div class="form-group">
				                                <label>과세여부</label>
				                                <div class="form-check">
										            <input type="hidden" value="N" name="taxYn"> 
										
										            <input class="form-check-input" type="checkbox" value="Y" name="taxYn"  >
										        </div>
				                            </div>
				                        </div>
				                        <div class="col-md-4 mb-3">
				                            <div class="form-group">
				                                <label>과세방식</label>
				                                <select class="form-select" name="taxType" onchange="checkTaxType(this)">
				                                    <option value="">선택...</option>
				                                    <option value="PERCENT">PERCENT</option>
				                                    <option value="AMOUNT">AMOUNT</option>
				                                </select>
				                            </div>
				                        </div>
				                        <div class="col-md-4 mb-3">
				                            <div class="form-group">
				                                <label>과세비율</label>
				                                <input type="number" step="0.01" class="form-control" min="0" max="999.99" name="taxPercent">
				                            </div>
				                        </div>
   										<div class="col-md-4 mb-3">
											<div class="form-group">
												<label>절사방식</label>
												<select class="form-select" name="roundType">
													<option value="WON">WON</option>
													<option value="TEN">TEN</option>
													<option value="HUNDRED">HUNDRED</option>
												</select>
											</div>
										</div>
										<div class="col-md-4 mb-3">
											<div class="form-group">
												<label>소급여부</label>
												<div class="form-check">
										            <input type="hidden" value="N" name="backPayYn"> 
										
										            <input class="form-check-input" type="checkbox" value="Y" name="backPayYn"  >
										        </div>
											</div>
										</div>
										<div class="col-md-4 mb-3">
											<div class="form-group">
												<label>4대보험 대상여부</label>
												<div class="form-check">
										            <input type="hidden" value="N" name="insuranceYn"> 
										
										            <input class="form-check-input" type="checkbox" value="Y" name="insuranceYn"  >
										        </div>
											</div>
										</div>
				                        </div>
				                        <div class="col-md-4 mb-3">
										<div class="form-group">
											<label>사용여부</label>
											<div class="form-check">
										            <input type="hidden" value="N" name="useYn"> 
										
										            <input class="form-check-input" type="checkbox" value="Y" name="useYn"  >
										        </div>
											</div>
										</div>
										<div class="col-md-8 mb-3">
											<div class="form-group">
												<label>비고</label>
												<textarea class="form-control" rows="2" name="note" maxlength="500"></textarea>
											</div>
										</div>
				                </form>
				                </div>
				            <div class="modal-footer gap-2">
				                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
				                <button type="button" class="btn btn-primary" onclick="updatePayItem()">변경사항 저장</button>
				            </div>
				        </div>
				    </div>
				</div>				
			</div>

			<footer th:replace= "~{common/footer :: footer}" ></footer>
		</div>
	</div>
	<th:block layout:fragment="script">
        <script src="/assets/js/pay/pay-item.js"></script>
    </th:block>
</body>

</html>